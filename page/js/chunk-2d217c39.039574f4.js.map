{"version":3,"sources":["webpack:///./src/views/Inverted.vue?2468","webpack:///./src/components/Inverted.vue?4336","webpack:///src/components/Inverted.vue","webpack:///./src/components/Inverted.vue?67b1","webpack:///./src/components/Inverted.vue","webpack:///src/views/Inverted.vue","webpack:///./src/views/Inverted.vue?29bd","webpack:///./src/views/Inverted.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","staticClass","attrs","img","on","$event","staticRenderFns","props","speed","type","Number","default","scale","waves","height","canvasId","String","data","image","started","notTime","Date","now","mounted","methods","startRender","_cvs","document","body","clientHeight","width","clientWidth","_ctx","drawImage","$refs","appendChild","init","cvs","style","top","parentNode","insertBefore","c","save","canvas","zIndex","imgLoad","restore","w","h","dw","dh","id","getImageData","end","odd","od","pixel","y","x","displacement","j","m","n","sign","offset","max_frames","frame","frames","push","setTimeout","removeChild","_now_time","putImageData","clearRect","fun","$emit","option","component","name","components","itd"],"mappings":"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","file":"js/chunk-2d217c39.039574f4.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('itd',{ref:\"test\",staticClass:\"inverted-test\",attrs:{\"src\":_vm.img},on:{\"update:src\":function($event){_vm.img=$event}}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"inverted-main\",staticClass:\"inverted\"})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"inverted\" ref=\"inverted-main\"></div>\n</template>\n<script>\nexport default {\n  props: {\n    speed: {\n      type: Number,\n      default: 0.25,\n    },\n    scale: {\n      type: Number,\n      default: 1,\n    },\n    waves: {\n      type: Number,\n      default: 10,\n    },\n    height: {\n      type: Number,\n      default: 0.5,\n    },\n    canvasId: {\n      type: String,\n      default: \"\",\n    },\n  },\n  data() {\n    return {\n      image: null,\n      started: false,\n      notTime: Date.now(),\n    };\n  },\n  mounted() {\n    // this.startRender(this.src);\n  },\n  methods: {\n    startRender(cvs) {\n      const _cvs = document.createElement(\"canvas\");\n      _cvs.height = document.body.clientHeight * this.height;\n      _cvs.width = document.body.clientWidth;\n      const _ctx = _cvs.getContext(\"2d\");\n      _ctx.drawImage(\n        cvs,\n        0,\n        0,\n        cvs.width,\n        cvs.height,\n        0,\n        0,\n        cvs.width,\n        cvs.height\n      );\n      if (this.started) {\n        return;\n      }\n      this.image = _cvs;\n      this.$refs[\"inverted-main\"].appendChild(this.image);\n      this.init();\n    },\n    init() {\n      const { waves, speed, scale, height, image } = this;\n      let cvs = document.createElement(\"canvas\");\n      cvs.style.top = 0;\n      let c = cvs.getContext(\"2d\");\n\n      let imgLoad = false;\n      const img = image;\n      img.parentNode.insertBefore(cvs, img);\n      let w = document.body.clientWidth,\n        h = document.body.clientHeight,\n        dw = w,\n        dh = h * height;\n\n      let offset = 0,\n        frame = 0,\n        max_frames = 0,\n        frames = [];\n      // img.onload = () => {\n      c.save();\n\n      c.canvas.width = img.width;\n      c.canvas.height = img.height * 2;\n      c.canvas.style.zIndex = \"5\";\n\n      c.drawImage(img, 0, 0);\n      c.scale(1, -1);\n      c.drawImage(img, 0, -img.height * 2);\n\n      imgLoad = true;\n\n      c.restore();\n\n      w = c.canvas.width;\n      h = c.canvas.height;\n      dw = w;\n      dh = h * height;\n\n      var id = c.getImageData(0, h * height, w, h).data; // 获取图片像素点阵色彩信息\n      var end = false;\n      c.save();\n      while (!end) {\n        var odd = c.getImageData(0, h * height, w, h);\n        var od = odd.data;\n        var pixel = 0;\n        for (var y = 0; y < dh; y++) {\n          // 对二维数组进行遍历\n          for (var x = 0; x < dw; x++) {\n            // 模拟正弦波 来计算像素点的偏移位置\n            var displacement =\n              (scale * 10 * Math.sin(dh / (y / waves) + -offset)) | 0;\n            var j = ((displacement + y) * w + x + displacement) * 4;\n            if (j < 0) {\n              pixel += 4;\n              continue;\n            }\n            var m = j % (w * 4);\n            var n = scale * 10 * (y / waves);\n            if (m < n || m > w * 4 - n) {\n              var sign = y < w / 2 ? 1 : -1;\n              od[pixel] = od[pixel + 4 * sign];\n              od[++pixel] = od[pixel + 4 * sign];\n              od[++pixel] = od[pixel + 4 * sign];\n              od[++pixel] = od[pixel + 4 * sign];\n              ++pixel;\n              continue;\n            }\n\n            if (id[j + 3] != 0) {\n              od[pixel] = id[j];\n              od[++pixel] = id[++j];\n              od[++pixel] = id[++j];\n              od[++pixel] = id[++j];\n              ++pixel;\n            } else {\n              od[pixel] = od[pixel - w * 4];\n              od[++pixel] = od[pixel - w * 4];\n              od[++pixel] = od[pixel - w * 4];\n              od[++pixel] = od[pixel - w * 4];\n              ++pixel;\n            }\n          }\n        }\n\n        if (offset > speed * (6 / speed)) {\n          offset = 0;\n          max_frames = frame - 1;\n          frame = 0;\n          end = true;\n        } else {\n          offset += speed;\n          frame++;\n        }\n        frames.push(odd);\n      }\n      c.restore();\n      if (!img) {\n        c.height = c.height / 2;\n      }\n      setTimeout(() => {\n        img.parentNode.removeChild(img);\n        this.started = true;\n      }, 3000);\n      // };\n      const fun = () => {\n        const _now_time = Date.now();\n        if (_now_time - this.notTime < 30) {\n          return;\n        }\n        this.notTime = _now_time;\n        if (imgLoad) {\n          if (!img) {\n            c.putImageData(frames[frame], 0, 0);\n          } else {\n            c.putImageData(frames[frame], 0, h * height);\n          }\n          c.clearRect(0, 0, 1920, 400);\n          if (frame < max_frames) {\n            frame++;\n          } else {\n            frame = 0;\n          }\n        }\n      };\n      const option = {\n        fun,\n      };\n      this.$emit(\"add\", option);\n      // setInterval(function () {\n      // }, 33.33);\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped></style>\n","import mod from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.2.3@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./Inverted.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.2.3@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./Inverted.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Inverted.vue?vue&type=template&id=6a1d8033&scoped=true&\"\nimport script from \"./Inverted.vue?vue&type=script&lang=js&\"\nexport * from \"./Inverted.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/_vue-loader@15.9.8@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6a1d8033\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div>\n    <itd class=\"inverted-test\" ref=\"test\" :src.sync=\"img\" />\n  </div>\n</template>\n<script>\nimport Itd from \"@/components/Inverted.vue\";\nexport default {\n  name: \"test\",\n  components: {\n    itd: Itd,\n  },\n  data() {\n    return {\n      img: `test.jpg`,\n    };\n  },\n  mounted() {\n    this.init();\n  },\n  methods: {\n    init() {},\n  },\n};\n</script>\n<style lang=\"scss\" scoped></style>\n","import mod from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.2.3@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./Inverted.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.2.3@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./Inverted.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Inverted.vue?vue&type=template&id=3d4e0b4b&scoped=true&\"\nimport script from \"./Inverted.vue?vue&type=script&lang=js&\"\nexport * from \"./Inverted.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/_vue-loader@15.9.8@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3d4e0b4b\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}